# FRAGMENTS

fragment DirectionF on Direction {
  id
  index
  description
  hint
}

fragment LessonF on Lesson {
  id
  index
  name
  description
}

fragment MutationResultF on MutationResult {
  ok
  errors {
    field
    message
  }
  pk
}

fragment MutationResultNoErrorsF on MutationResult {
  ok
}

fragment SlideF on Slide {
  id
  index
  name
  description
  startingCode
  directionSet {
    ...DirectionF
  }
}

fragment WorkshopContributorsF on Workshop {
  id
  name
  slug
  description
  contributors {
    id
    username
  }
}

fragment WorkshopF on Workshop {
  id
  name
  slug
  description
}

fragment UserF on User {
  username
  bio
  contributedWorkshopSet {
    ...WorkshopF
    author {
      username
    }
  }
}

# QUERIES

query AllWorkshops {
  allWorkshops {
    ...WorkshopF
    author {
      username
    }
  }
}

query CurrentUser_minimal {
  currentUser {
    username
  }
}

query Lesson ($workshop: String!, $human: String!, $lesson: Int!) {
  lesson(workshop: $workshop, human: $human, lesson: $lesson) {
    ...LessonF
  }

  lessonSlides(lesson: $lesson, workshop: $workshop, human: $human) {
    ...SlideF
  }
}

query LessonSlides ($lesson: Int!, $workshop: String!, $human: String!) {
  lessonSlides(lesson: $lesson, workshop: $workshop, human: $human) {
    ...SlideF
  }
}

query LessonSlides_minimal ($lesson: Int!, $workshop: String!, $human: String!) {
  lessonSlides(lesson: $lesson, workshop: $workshop, human: $human) {
    id
  }
  lesson(lesson: $lesson, workshop: $workshop, human: $human) {
    id
    name
  }
}

query Slide ($workshop: String!, $human: String!, $lesson: Int!, $slide: Int!) {
  slide(workshop: $workshop, human: $human, lesson: $lesson, slide: $slide) {
    ...SlideF
  }
}

query User ($human: String!) {
  user(human: $human) {
    ...UserF
  }

  userWorkshops(human: $human) {
    ...WorkshopF
    author {
      username
    }
  }
}

query UserWorkshops ($human: String!) {
  userWorkshops(human: $human) {
    ...WorkshopF
    author {
      username
    }
  }
}

query Workshop ($workshop: String!, $human: String!) {
  workshop(workshop: $workshop, human: $human) {
    ...WorkshopContributorsF
  }
  workshopLessons(workshop: $workshop, human: $human) {
    ...LessonF
  }
}

query WorkshopContributors ($workshop: String!, $human: String!) {
  workshop(workshop: $workshop, human: $human) {
    ...WorkshopContributorsF
  }
  workshopLessons(workshop: $workshop, human: $human) {
    ...LessonF
  }
}

query WorkshopLessons ($workshop: String!, $human: String!) {
  workshopLessons(workshop: $workshop, human: $human) {
    ...LessonF
  }
}

# MUTATIONS

mutation CreateDirection ($description: String!, $slide: ID!) {
  createDirection(description: $description, slide: $slide) {
    ...MutationResultF
  }
}

mutation CreateLesson ($name: String, $workshop: ID!) {
  createLesson(name: $name, workshop: $workshop) {
    ...MutationResultF
  }
}

mutation CreateSlide ($name: String, $lesson: ID!) {
  createSlide(name: $name, lesson: $lesson) {
    ...MutationResultF
  }
}

mutation CreateWorkshop ($name: String!) {
  createWorkshop(name: $name) {
    ...MutationResultF
  }
}

mutation DeleteDirection ($pk: ID!) {
  deleteDirection(pk: $pk) {
    ...MutationResultNoErrorsF
  }
}

mutation DeleteLesson ($pk: ID!) {
  deleteLesson(pk: $pk) {
    ...MutationResultNoErrorsF
  }
}

mutation DeleteSlide ($pk: ID!) {
  deleteSlide(pk: $pk) {
    ...MutationResultNoErrorsF
  }
}

mutation DeleteWorkshop ($pk: ID!) {
  deleteWorkshop(pk: $pk) {
    ...MutationResultNoErrorsF
  }
}

mutation EditDirection ($pk: ID!, $description: String) {
  editDirection(pk: $pk, description: $description) {
    ...MutationResultF
  }
}

mutation EditLesson ($pk: ID!, $description: String, $name: String) {
  editLesson(pk: $pk, description: $description, name: $name) {
    ...MutationResultF
  }
}

mutation EditSlide ($pk: ID!, $startingCode: String, $description: String, $name: String) {
  editSlide(pk: $pk, startingCode: $startingCode description: $description, name: $name) {
    ...MutationResultF
  }
}

mutation EditWorkshop ($pk: ID!, $description: String, $contributors: [String!], $sourceUrl: String) {
  editWorkshop(pk: $pk, description: $description, contributors: $contributors, sourceUrl: $sourceUrl) {
    ...MutationResultF
  }
}

mutation LoginUser ($username: String!, $password: String!) {
  loginUser(username: $username, password: $password) {
    ok
  }
}

mutation LogoutUser {
  logoutUser {
    ok
  }
}

mutation MoveDirection ($pk: ID!, $index: Int!) {
  moveDirection(pk: $pk, index: $index) {
    ...MutationResultNoErrorsF
  }
}

mutation MoveLesson ($pk: ID!, $index: Int!) {
  moveLesson(pk: $pk, index: $index) {
    ...MutationResultNoErrorsF
  }
}

mutation MoveSlide ($pk: ID!, $index: Int!) {
  moveSlide(pk: $pk, index: $index) {
    ...MutationResultNoErrorsF
  }
}

mutation Signup ($username: String!, $email: String!, $password: String!, $bio: String, $location: String) {
  createUser(username: $username, email: $email, password: $password, bio: $bio, location: $location) {
    ...MutationResultF
  }
}

mutation SyncWorkshop ($pk: ID!) {
  syncWorkshop(pk: $pk) {
    ok
    error
  }
}
